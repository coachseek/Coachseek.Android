angular.module("app.controllers",[]).controller("appCtrl",["$rootScope","$location","$state","$http","$timeout","loginModal","onlineBookingAPIFactory",function(a,b,c,d,e,f,g){a.addAlert=function(b){_.forEach(a.alerts,function(c,d){c&&c.message===b.message&&a.closeAlert(d)}),_.assign(b,{dismissTimeout:"success"===b.type?3e3:5e3}),a.alerts.push(b)},a.handleErrors=function(b){_.forEach(b.data,function(b){a.addAlert({type:"danger",message:b.message?b.message:b})})},a.closeAlert=function(b){a.alerts.splice(b,1)},a.removeAlerts=function(b){a.alerts=[]},a.logout=function(){d.defaults.headers.common.Authorization=null,delete a.currentUser,Intercom("shutdown"),a.addAlert({type:"success",message:"logged-out"}),f().then(function(){return a.removeAlerts(),c.go(c.current,{},{reload:!0})})},a.login=function(){f().then(function(){a.removeAlerts(),c.go("scheduling")})};var h=function(a,b){window.Intercom&&Intercom("boot",{app_id:"udg0papy",name:a.firstName&&a.lastName?a.firstName+" "+a.lastName:a.email,email:a.email,created_at:b})};a.setupCurrentUser=function(b){a.setUserAuth(b.email,b.password),h(b,_.now()),a.currentUser=b},a.setUserAuth=function(a,b){var c="Basic "+btoa(a+":"+b);d.defaults.headers.common.Authorization=c},a.redirectToApp=function(){e(function(){window.location="https://app.coachseek.com"},5e3)},a.$on("$stateChangeStart",function(b,d,e){var g=d.data.requireLogin;g&&!a.currentUser?(b.preventDefault(),f().then(function(){return a.removeAlerts(),c.go(d.name,e)})):a.removeAlerts()}),a.isCollapsed=!0,a.isBigScreen=$(window).width()>768,$(window).on("resize",function(){a.isBigScreen=$(this).width()>768,a.$apply()})}]).controller("loginModalCtrl",["$scope","coachSeekAPIService","$http","$activityIndicator","$window",function(a,b,c,d,e){a.attemptLogin=function(e,f){if(a.removeAlerts(),a.loginForm.$valid)a.setUserAuth(e,f),d.startAnimating(),b.get({section:"Business"}).$promise.then(function(b){var c={email:e,password:f,business:b};a.$close(c)},function(b){c.defaults.headers.common.Authorization=null,a.addAlert({type:"danger",message:b.statusText})})["finally"](function(){d.stopAnimating()});else{var g=a.loginForm.$error;_.forEach(g,function(b,c){_.forEach(b,function(b){var c=b.$name;a.addAlert({type:"warning",message:"businessSetup:"+c+"-invalid"})})})}},a.cancel=a.$dismiss}]).controller("comingSoonCtrl",["$scope",function(a){a.saveFeedback=function(){Intercom("trackEvent","feedback",{feedback:a.feedback}),a.feedbackSent=!0}}]),angular.module("app.directives",[]).directive("durationPicker",function(){return{scope:{duration:"="},restrict:"E",templateUrl:"app/partials/durationPicker.html",link:function(a,b){a.editingTime=!1;var c,d,e,f=angular.element(b.find(".time-picker-container"));a.$watch("duration",function(b){a.duration=b,a.duration&&(e=Math.floor(a.duration/60),d=a.duration%60,a.time=h()+":"+g())}),a.$watch("time",function(b,c){if(b){var f=a.time.split(":");e=parseFloat(f[0]),d=parseFloat(f[1]),0===e&&0===d?a.time=c:a.duration=60*e+d}}),a.editTime=function(b){a.editingTime||(c=angular.copy(a.duration),a.editingTime=!0)},a.$on("closeTimePicker",function(b,d){d&&c&&(a.duration=c),a.editingTime=!1,f.one("$animate:after",function(){c=null})});var g=function(){return 9>=d?"0"+d:d},h=function(){return 9>=e?"0"+e:e}}}}).directive("activityIndicator",function(){return{replace:!0,templateUrl:"app/partials/activityIndicator.html"}}).directive("ngTabAdd",function(){return function(a,b,c){$(window).on("keydown keypress",function(b){9===b.which&&a.$apply(function(){a.$eval(c.ngTabAdd)})})}}).directive("ngEnter",function(){return function(a,b,c){b.on("keydown keypress",function(b){13===b.which&&(a.$apply(function(){a.$eval(c.ngEnter)}),b.preventDefault())})}}).directive("selectArrows",function(){return{restrict:"E",templateUrl:"app/partials/selectArrows.html"}}).directive("ellipsisAnimated",function(){return{restrict:"EAC",templateUrl:"app/partials/ellipsisAnimated.html"}}).directive("loadingAnimation",function(){return{restrict:"E",templateUrl:"app/partials/loadingAnimation.html"}}),angular.module("app",["ngAnimate","ngMessages","ngSanitize","ngResource","ngTouch","ui.bootstrap","ui.router","jm.i18next","angularMoment","app.controllers","app.services","app.directives","businessSetup","scheduling","customers","booking","ngActivityIndicator","ngClipboard"]).config(["$i18nextProvider",function(a){a.options={lng:"en",fallbackLng:"en",ns:{namespaces:["app","businessSetup","scheduling","customers","booking"],defaultNs:"app"},resGetPath:"i18n/__lng__.json",defaultLoadingValue:""}}]).config(["$urlRouterProvider","$stateProvider",function(a,b){a.otherwise(function(a){var b=a.get("$state");b.go("scheduling")}),b.state("comingSoon",{templateUrl:"app/partials/comingSoon.html",controller:"comingSoonCtrl",data:{requireLogin:!0}}).state("comingSoon.dashboard",{url:"/dashboard/coming-soon"}).state("comingSoon.financials",{url:"/financials/coming-soon"})}]).config(["$compileProvider",function(a){a.debugInfoEnabled(!1)}]).run(["$rootScope","$state","$stateParams",function(a,b,c){FastClick.attach(document.body),a.$state=b,a.$stateParams=c,a.alerts=[]}]),angular.module("app.services",[]).factory("coachSeekAPIService",["$resource",function(a){return a("https://api.coachseek.com/:section/:id")}]).factory("anonCoachseekAPIFactory",["$resource",function(a){return{anon:function(b){return a("https://api.coachseek.com/:section/:id",{},{get:{method:"GET",headers:{"Business-Domain":b}}})}}}]).service("CRUDService",["coachSeekAPIService","$activityIndicator",function(a,b){this.get=function(c,d){b.startAnimating(),a.query({section:c}).$promise.then(function(a){_.size(a)?d.itemList=a:(d.itemList=[],d.createItem())},d.handleErrors)["finally"](function(){b.stopAnimating()})},this.update=function(e,f,g){return b.startAnimating(),a.save({section:e},g).$promise.then(function(a){if(f.itemList&&f.itemList.push(a),f.newItem){var b={};b[e]=f.itemList.length,Intercom("update",b)}return c(f),f.addAlert({type:"success",message:"businessSetup:save-success",name:a.name?a.name:d(a)}),f.$broadcast("updateSuccess"),a},f.handleErrors)["finally"](function(){b.stopAnimating()})},this.cancelEdit=function(a){a.newItem||a.itemList.push(a.itemCopy),c(a)},this.validateForm=function(a){var b=a.itemForm.$valid;if(!b){var c=a.itemForm.$error;_.forEach(c,function(b,c){_.forEach(b,function(b){var d=b&&b.$name?b.$name:c;a.addAlert({type:"warning",message:"businessSetup:"+d+"-invalid"})})})}return b};var c=function(a){a.item=null,a.itemForm.$setPristine(),a.itemForm.$setUntouched(),a.removeAlerts(),a.newItem=null,a.itemCopy=null},d=function(a){return a.firstName&&a.lastName?a.firstName+" "+a.lastName:a.business?a.business.name:void 0}}]).service("loginModal",["$modal","$rootScope",function(a,b){function c(a){return b.setupCurrentUser(a),a}return function(){var b=a.open({templateUrl:"app/partials/loginModal.html",controller:"loginModalCtrl",backdropClass:"modal-backdrop",backdrop:"static",keyboard:!1});return b.result.then(c)}}]),angular.module("booking.controllers",[]).controller("bookingCtrl",["$scope","$state","onlineBookingAPIFactory","currentBooking",function(a,b,c,d){a.currentBooking=d,a.selectEvent=function(b){a.selectedEvent!==b&&(d.resetBooking(),a.selectedEvent=b,a.availableSessions=_.filter(b.sessions,function(b){return!a.isBefore(b)&&a.getSessionSpacesAvailable(b)>0}),(!b.sessions||b.pricing.coursePrice&&!b.pricing.sessionPrice)&&a.toggleEntireCourse())},a.closeEvent=function(){event.stopPropagation(),d.resetBooking(),delete a.selectedEvent},a.toggleSessionSelect=function(b){_.includes(d.booking.sessions,b)?d.booking.sessions=_.without(d.booking.sessions,b):d.booking.sessions.push(b),_.size(d.booking.sessions)===_.size(a.availableSessions)?d.booking.course=a.selectedEvent:d.booking.course=null},a.toggleEntireCourse=function(){d.booking.course===a.selectedEvent?d.resetBooking():d.booking={course:a.selectedEvent,sessions:a.availableSessions}},a.getSessionSpacesAvailable=function(a){var b=a.booking.studentCapacity-a.booking.bookingCount;return b>0?b:0},a.isBefore=function(a){return moment(a.timing.startDate,"YYYY-MM-DD").isBefore(moment())}}]).controller("bookingSelectionCtrl",["$scope","anonCoachseekAPIFactory","currentBooking",function(a,b,c){function d(){a.events=_.intersection(i,j)}function e(b){return _.find(a.services,function(a){return a.id===b})}function f(b){return _.find(a.locations,function(a){return a.id===b})}function g(a){return moment(a.startDate,"YYYY-MM-DD")}function h(){_.each(c.allEvents,function(b){f(b.location.id)||a.locations.push(b.location),e(b.service.id)||a.services.push(b.service)})}var i,j;a.locations=[],a.services=[],a.$watch("currentBooking.filters.service",function(c){_.size(c)&&(a.loadingSessions=!0,b.anon(a.business.domain).get({section:"Services",id:c.id}).$promise.then(function(b){a.serviceDescription=b.description},a.handleErrors)["finally"](function(){a.loadingSessions=!1}))}),a.filterByLocation=function(b){b&&(c.resetBooking(),delete c.filters.service),delete a.selectedEvent,delete a.serviceDescription,i=_.filter(c.allEvents,function(b){return b.location.id===a.currentBooking.filters.location.id}),a.services=[],_.each(i,function(b){e(b.service.id)||a.services.push(b.service)}),d()},a.filterByService=function(b){b&&c.resetBooking(),delete a.selectedEvent,delete a.serviceDescription,j=_.filter(c.allEvents,function(b){return b.service.id===a.currentBooking.filters.service.id}),d()},a.disableContinue=function(){return _.isEmpty(c.booking.sessions)&&_.isEmpty(c.booking.course)},c.allEvents?(a.eventsExist=_.size(c.allEvents),h(),a.filterByLocation(),a.filterByService()):(delete a.serviceDescription,a.loadingSessions=!0,c.getAllEvents(a.business.domain).then(function(b){c.allEvents=_.sortBy(_.union(b.courses,b.sessions),function(a){return g(a.timing).valueOf()}),a.eventsExist=_.size(c.allEvents),h()},a.handleErrors)["finally"](function(){a.loadingSessions=!1}))}]).controller("bookingCustomerDetailsCtrl",["$scope","$state","currentBooking",function(a,b,c){c.filters.location||b.go("booking.selection")}]).controller("bookingPaymentCtrl",["$scope",function(a){a.initPaypalPayment=function(){null===a.coursePaymentPrice},a.payLaterCall=function(){}}]).controller("bookingConfirmationCtrl",["$scope","$q","$state","onlineBookingAPIFactory","currentBooking",function(a,b,c,d,e){function f(b){if(e.booking.course&&_.size(a.availableSessions)===_.size(e.booking.course.sessions))return g(e.booking.course,b);if(e.booking.sessions){var c=[];return _.each(e.booking.sessions,function(a){c.push(g(a,b))}),c}}function g(b,c){var e={customer:c,session:b,paymentStatus:"awaiting-invoice",hasAttended:!1};return d.anon(a.business.domain).save({section:"Bookings"},e).$promise}a.bookingConfirmed=!1,e.filters.location||c.go("booking.selection"),a.processBooking=function(){a.processingBooking=!0,d.anon(a.business.domain).save({section:"Customers"},e.customer).$promise.then(function(c){b.all(f(c)).then(function(){a.bookingConfirmed=!0},a.handleErrors)["finally"](function(){a.processingBooking=!1})},a.handleErrors)},a.resetBookings=function(){e.resetBooking(),e.filters={},delete e.allEvents,c.go("booking.selection")}}]).controller("bookingAdminCtrl",["$scope","$templateCache","$compile",function(a,b,c){var d=b.get("booking/partials/bookNowButton.html"),e=c(d)(a);_.defer(function(){a.buttonHTML=e.get(0).outerHTML,a.$apply()})}]),angular.module("booking.directives",[]).directive("bookingRectangle",function(){return{restrict:"E",templateUrl:"booking/partials/bookingRectangle.html",link:function(a){function b(){var b=a.event;if(a.isBefore(b)){if(b.pricing.sessionPrice>=0)return c(b.sessions);var d=_.size(_.filter(b.sessions,function(b){return!a.isBefore(b)}));return(b.pricing.coursePrice/b.repetition.sessionCount*d).toFixed(0)}return b.pricing.coursePrice||c(b.sessions)}function c(b){return _.sum(b,function(b){return a.isBefore(b)||a.getSessionSpacesAvailable(b)<=0?0:b.pricing.sessionPrice})}function d(){var b,c=a.event.booking;return b=a.event.sessions?c.studentCapacity-e():c.studentCapacity-c.bookingCount,b>0?b:0}function e(){var b=_.filter(a.event.sessions,function(a){return f(a.timing).isAfter()});return _.max(b,"booking.bookingCount").booking.bookingCount}function f(a){return moment(a.startDate+" "+a.startTime,"YYYY-MM-DD HH:mm")}a.selected=!1;var g=moment(a.event.timing.startDate+" "+a.event.timing.startTime,"YYYY-MM-DD HH:mm");a.spacesAvailable=d(),a.fullCoursePrice=b(),a.getEventDateRange=function(){if(a.event.sessions){var b=a.event.repetition;return g.format("dddd Do MMM")+" – "+g.clone().add(b.sessionCount-1,b.repeatFrequency).format("dddd Do MMM")}return g.format("dddd Do MMM")},a.getEventTimeRange=function(){return g.format("h:mm A")+" – "+g.clone().add(a.event.timing.duration,"minutes").format("h:mm A")},a.toggleEventSelect=function(){a.selected=!a.selected,a.selectEvent(a.event)}}}}).directive("bookingCourseSessions",["currentBooking",function(a){return{restrict:"E",templateUrl:"booking/partials/bookingCourseSessions.html",link:function(b){function c(a){return moment(a.startDate+" "+a.startTime,"YYYY-MM-DD HH:mm")}b.getSessionDate=function(a){return c(a.timing).format("dddd Do MMM")},b.getEventTimeRange=function(a){var b=c(a.timing);return b.format("h:mm A")+" – "+b.clone().add(a.timing.duration,"minutes").format("h:mm A")},b.isSelected=function(b){return _.includes(a.booking.sessions,b)}}}}]).directive("bookingDateRange",["currentBooking",function(a){return{restrict:"E",templateUrl:"booking/partials/bookingDateRange.html",link:function(b){function c(a){return moment(a.startDate,"YYYY-MM-DD")}function d(a,b){var c=moment(a.startDate+" "+a.startTime,"YYYY-MM-DD HH:mm"),d=c.clone().add(b.sessionCount-1,b.repeatFrequency);return moment.range(c,d)}b.calculateBookingDateRange=function(){if(a.booking.course){var b=a.booking.course,e=d(b.timing,b.repetition);return _.size(a.booking.sessions)?e.start.format("dddd Do MMM")+" – "+e.end.format("dddd Do MMM"):e.start.format("dddd Do MMM")}if(a.booking.sessions){var f=[];if(_.each(a.booking.sessions,function(a){f.push(c(a.timing))}),f=_.sortBy(f,function(a){return a.valueOf()}),1===_.size(f))return _.first(f).format("dddd Do MMM");if(_.size(f)){var e=moment.range(_.first(f),_.last(f));return e.start.format("dddd Do MMM")+" – "+e.end.format("dddd Do MMM")}}}}}}]).directive("bookingPrice",["currentBooking",function(a){return{restrict:"E",templateUrl:"booking/partials/bookingPrice.html",link:function(b){function c(a){return moment(a.timing.startDate,"YYYY-MM-DD").isBefore(moment())}b.calculateTotalPrice=function(){var d=a.booking.course;if(d){if(d.sessions){if(c(d)){if(d.pricing.coursePrice&&!d.pricing.sessionPrice){var e=_.size(_.filter(d.sessions,function(a){return!c(a)}));return(d.pricing.coursePrice/d.repetition.sessionCount*e).toFixed(2)}return(_.size(b.availableSessions)*d.pricing.sessionPrice).toFixed(2)}return d.pricing.coursePrice?d.pricing.coursePrice.toFixed(2):(_.size(b.availableSessions)*d.pricing.sessionPrice).toFixed(2)}return d.pricing.sessionPrice.toFixed(2)}return a.booking.sessions?_.sum(a.booking.sessions,"pricing.sessionPrice").toFixed(2):"0.00"}}}}]),angular.module("booking",["booking.controllers","booking.directives","booking.services"]).config(["$stateProvider",function(a){a.state("bookingAdmin",{url:"/booking-admin",templateUrl:"booking/partials/bookingAdminView.html",controller:"bookingAdminCtrl",data:{requireLogin:!0}}).state("booking",{url:"/booking","abstract":!0,templateUrl:"booking/partials/booking.html",controller:"bookingCtrl"}).state("booking.selection",{url:"/selection",views:{"booking-view":{templateUrl:"booking/partials/bookingSelectionView.html",controller:"bookingSelectionCtrl"}},data:{requireLogin:!1,requireBusinessDomain:!0}}).state("booking.details",{url:"/details",views:{"booking-view":{templateUrl:"booking/partials/bookingCustomerDetailsView.html",controller:"bookingCustomerDetailsCtrl"}},data:{requireLogin:!1,requireBusinessDomain:!0}}).state("booking.payment",{url:"/payment",views:{"booking-view":{templateUrl:"booking/partials/bookingPaymentView.html",controller:"bookingPaymentCtrl"}},data:{requireLogin:!1,requireBusinessDomain:!0}}).state("booking.confirmation",{url:"/confirmation",views:{"booking-view":{templateUrl:"booking/partials/bookingConfirmationView.html",controller:"bookingConfirmationCtrl"}},data:{requireLogin:!1,requireBusinessDomain:!0}})}]),angular.module("booking.services",[]).factory("onlineBookingAPIFactory",["$resource",function(a){return{anon:function(b){return a("https://api.coachseek.com/OnlineBooking/:section",{},{get:{method:"GET",headers:{"Business-Domain":b}},query:{method:"GET",isArray:!0,headers:{"Business-Domain":b}},save:{method:"POST",headers:{"Business-Domain":b}}})}}}]).service("currentBooking",["onlineBookingAPIFactory",function(a){this.customer={},this.booking={sessions:[]},this.filters={},this.resetBooking=function(){this.booking={sessions:[]}},this.getAllEvents=function(b){var c={endDate:moment().add(12,"week").format("YYYY-MM-DD"),startDate:moment().add(1,"day").format("YYYY-MM-DD"),section:"Sessions"};return a.anon(b).get(c).$promise}}]),angular.module("businessSetup.controllers",[]).controller("businessRegistrationCtrl",["$scope","coachSeekAPIService","CRUDService","$activityIndicator","$state",function(a,b,c,d,e){a.business={},a.admin={},a.saveItem=function(){var f=c.validateForm(a);f&&(d.startAnimating(),b.save({section:"businessRegistration"},{admin:a.admin,business:a.business}).$promise.then(function(b){a.setupCurrentUser({email:a.admin.email,password:a.admin.password,business:b.business}),e.go("businessSetup.locations")},a.handleErrors)["finally"](function(){d.stopAnimating()}))}}]).controller("businessCtrl",["$scope","CRUDService",function(a,b){a.editItem=function(){a.itemCopy=angular.copy(a.business),a.item=a.business},a.saveItem=function(c){var d=b.validateForm(a);d&&b.update("Business",a,c).then(function(b){a.currentUser.business=b})},a.cancelEdit=function(){a.business=a.itemCopy,a.item=null,a.itemForm.$setPristine(),a.itemForm.$setUntouched(),a.removeAlerts(),a.itemCopy=null},a.business=a.currentUser.business}]).controller("locationsCtrl",["$scope","CRUDService",function(a,b){a.createItem=function(){a.item||(a.newItem=!0,a.item={})},a.editItem=function(b){_.pull(a.itemList,b),a.itemCopy=angular.copy(b),a.item=b},a.saveItem=function(c){var d=b.validateForm(a);d&&b.update("Locations",a,c)},a.cancelEdit=function(){b.cancelEdit(a)},a.$watch("item.name",function(b){_.find(a.itemList,{name:b})?a.itemForm.name.$setValidity("duplicatename",!1):a.itemForm.name.$setValidity("duplicatename",!0)}),b.get("Locations",a)}]).controller("coachesCtrl",["$scope","CRUDService","coachDefaults",function(a,b,c){a.createItem=function(){a.item||(a.newItem=!0,a.item=angular.copy(c))},a.editItem=function(b){_.pull(a.itemList,b),a.itemCopy=angular.copy(b),a.item=b},a.cancelEdit=function(){a.$broadcast("closeTimePicker",!0),b.cancelEdit(a)},a.saveItem=function(c){var d=b.validateForm(a);d&&(a.$broadcast("closeTimePicker",!1),b.update("Coaches",a,c))},a.$watchGroup(["item.firstName","item.lastName"],function(b){var c=b[0],d=b[1];_.find(a.itemList,{firstName:c,lastName:d})?(a.itemForm.firstName.$setValidity("duplicatename",!1),a.itemForm.lastName.$setValidity("duplicatename",!1)):(a.itemForm.firstName.$setValidity("duplicatename",!0),a.itemForm.lastName.$setValidity("duplicatename",!0))}),b.get("Coaches",a)}]).value("coachDefaults",{workingHours:{monday:{isAvailable:!0,startTime:"9:00",finishTime:"17:00"},tuesday:{isAvailable:!0,startTime:"9:00",finishTime:"17:00"},wednesday:{isAvailable:!0,startTime:"9:00",finishTime:"17:00"},thursday:{isAvailable:!0,startTime:"9:00",finishTime:"17:00"},friday:{isAvailable:!0,startTime:"9:00",finishTime:"17:00"},saturday:{isAvailable:!1,startTime:"9:00",finishTime:"17:00"},sunday:{isAvailable:!1,startTime:"9:00",finishTime:"17:00"}}}).controller("servicesCtrl",["$scope","$state","CRUDService","serviceDefaults",function(a,b,c,d){a.createItem=function(){a.item||(a.newItem=!0,a.item=angular.copy(d))},a.editItem=function(b){_.pull(a.itemList,b),a.itemCopy=angular.copy(b),a.item=b},a.saveItem=function(b){var d=c.validateForm(a);d&&(a.$broadcast("closeTimePicker",!1),c.update("Services",a,b))},a.cancelEdit=function(){a.$broadcast("closeTimePicker",!0),c.cancelEdit(a)},a.$watch("item.name",function(b){_.find(a.itemList,{name:b})?a.itemForm.name.$setValidity("duplicatename",!1):a.itemForm.name.$setValidity("duplicatename",!0)}),a.$watch("item.repetition.sessionCount",function(b){a.item&&2>b&&a.item.pricing&&delete a.item.pricing.coursePrice}),c.get("Services",a),b.current.data&&b.current.data.newService&&(a.AILoading=!1,a.createItem())}]).value("serviceDefaults",{booking:{isOnlineBookable:!0},timing:{duration:60},repetition:{sessionCount:1},presentation:{colour:"green"}}),angular.module("businessSetup.directives",[]).directive("repeatSelector",function(){return{restrict:"E",scope:{repeatFrequency:"=",sessionCount:"="},templateUrl:"businessSetup/partials/repeatSelector.html",link:function(a,b,c){a.frequencies=[{value:"w",text:"weekly"},{value:"d",text:"daily"}],a.repeatableOptions=[{value:!1,text:"no"},{value:!0,text:"yes"}],a.$watch("sessionCount",function(b){a.isFocused||(a.isRepeatable=b>1,2>b?delete a.repeatFrequency:b>1&&!a.repeatFrequency&&(a.repeatFrequency="d"))}),a.setValues=function(){1===a.sessionCount?a.isRepeatable=!1:a.sessionCount<2&&(a.sessionCount=1),a.isFocused=!1},a.toggleRepeatable=function(){a.sessionCount<2?a.sessionCount=2:a.sessionCount=1,a.setValues()},a.showStatus=function(){var b=_.filter(a.frequencies,{value:a.repeatFrequency});return b[0]?"businessSetup:repeat-selector."+b[0].text+"-plural":""}}}}).directive("colorPicker",function(){var a=["green","mid-green","dark-green","red","dark-red","yellow","orange","blue","mid-blue","dark-blue"];return{scope:{currentColor:"="},templateUrl:"businessSetup/partials/colorPicker.html",link:function(b){b.colors=a,b.$watch("currentColor",function(a){b.currentColor=a})}}}).directive("currencyPicker",function(){return{restrict:"E",replace:!0,templateUrl:"businessSetup/partials/currencyPicker.html",link:function(a){a.currencies=["NZD","USD","AUD","EUR","GBP","SEK"]}}}).directive("timeSlot",function(){return{replace:!1,templateUrl:"businessSetup/partials/timeSlot.html",link:function(a){a.weekdays=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"]}}}).directive("timePicker",function(){return{replace:!0,templateUrl:"businessSetup/partials/timePicker.html",scope:{time:"="},link:function(a,b,c){a.$watch("time",function(b){if(a.time=b,a.time){var c=a.time.split(":");a.hours=parseFloat(c[0]),a.minutes=parseFloat(c[1]),a.displayHours=e(),a.displayMinutes=d()}}),a.increaseHours=function(){a.hours<23?a.hours++:a.hours=0,f()},a.decreaseHours=function(){a.hours=a.hours<=0?23:--a.hours,f()},a.increaseMinutes=function(){a.minutes>=45?(a.minutes=0,a.increaseHours()):a.minutes=a.minutes+15,f()},a.decreaseMinutes=function(){a.minutes<=0?(a.minutes=45,a.decreaseHours()):a.minutes=a.minutes-15,f()},a.cancelEdit=function(){a.$emit("closeTimePicker",!0)},a.saveEdit=function(){a.$emit("closeTimePicker",!1)};var d=function(){return a.minutes<=9?"0"+a.minutes:a.minutes},e=function(){return a.hours<=9?"0"+a.hours:a.hours},f=function(){var b=d(),c=e();a.displayHours=c,a.displayMinutes=b,a.time=c+":"+b}}}}).directive("timeRangePicker",["$rootScope",function(a){return{replace:!1,scope:{workingHours:"="},templateUrl:"businessSetup/partials/timeRangePicker.html",require:"ngModel",link:function(b,c,d,e){var f,g=angular.element(c.find(".time-picker-container"));b.currentTime=null,b.$watchCollection("workingHours",function(a){if(a){var b=h(a.startTime),c=h(a.finishTime);a.isAvailable===!1||b.hours===c.hours&&b.minutes<c.minutes||b.hours<c.hours?e.$setValidity("timeRange",!0):(b.hours===c.hours&&b.minutes>=c.minutes||b.hours>c.hours)&&e.$setValidity("timeRange",!1)}});var h=function(a){var b=a.split(":");return a={},a.hours=parseFloat(b[0]),a.minutes=parseFloat(b[1]),a};b.editTime=function(a){null===b.currentTime&&(f=angular.copy(b.workingHours)),b.currentTime=a,b.editingTime=!0},b.$on("closeTimePicker",function(c,d){e.$valid||d?(d&&f&&(b.workingHours=f),b.editingTime=!1,g.one("$animate:after",function(){f=null,b.currentTime=null})):a.addAlert({type:"warning",message:"businessSetup:timeRange-invalid"})})}}}]),angular.module("businessSetup",["businessSetup.controllers","businessSetup.directives"]).config(["$stateProvider",function(a){a.state("newUserSetup",{url:"/new-user-setup",templateUrl:"businessSetup/partials/businessRegistrationView.html",controller:"businessRegistrationCtrl",data:{requireLogin:!1}}).state("businessSetup",{url:"/business-setup",templateUrl:"businessSetup/partials/businessSetup.html"}).state("businessSetup.business",{url:"/business",views:{"list-item-view":{templateUrl:"businessSetup/partials/businessView.html",controller:"businessCtrl"}},data:{requireLogin:!0}}).state("businessSetup.locations",{url:"/locations",views:{"list-item-view":{templateUrl:"businessSetup/partials/locationsView.html",controller:"locationsCtrl"}},data:{requireLogin:!0}}).state("businessSetup.coachList",{url:"/coach-list",views:{"list-item-view":{templateUrl:"businessSetup/partials/coachesView.html",controller:"coachesCtrl"}},data:{requireLogin:!0}}).state("businessSetup.services",{url:"/services",views:{"list-item-view":{templateUrl:"businessSetup/partials/servicesView.html",controller:"servicesCtrl"}},data:{requireLogin:!0}}).state("businessSetup.services.newItem",{url:"/new-item",data:{newService:!0,requireLogin:!0},views:{"list-item-view":{templateUrl:"businessSetup/partials/servicesView.html",controller:"servicesCtrl"}}})}]),angular.module("customers.controllers",[]).controller("customersCtrl",["$scope","CRUDService",function(a,b){a.createItem=function(){a.item||(a.newItem=!0,a.item={})},a.editItem=function(b){_.pull(a.itemList,b),a.itemCopy=angular.copy(b),a.item=b},a.saveItem=function(c){var d=b.validateForm(a);d&&b.update("Customers",a,c)},a.cancelEdit=function(){b.cancelEdit(a)},a.$watchCollection("item",function(b){b&&(""===b.email?delete a.item.email:""===b.phone&&delete a.item.phone)}),b.get("Customers",a)}]).controller("customerSearchCtrl",["$scope","$filter",function(a,b){var c;a.alphabetLetters=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","ALL"],a.loadMore=function(){c&&_.forEach(c.shift(),function(b){a.customerList.push(b)})};var d=function(){c=a.itemList,a.searchLetter&&(c=b("byLastName")(c,a.searchLetter)),c=b("searchBox")(c,a.searchText),c=b("orderBy")(c,["lastName","firstName"]),c=_.chunk(c,20),a.customerList=[],a.loadMore()};a.$on("updateSuccess",function(){d()});var e=a.$watch("itemList",function(a){a&&(d(),e())});a.$watch("searchText",function(b){""===b&&(a.searchText=null),d()}),a.$watchGroup(["searchLetter","searchText"],function(b){b[0]?b[1]?a.filterHighlight=b[1]+" "+b[0]:a.filterHighlight=b[0]:a.filterHighlight=b[1]}),a.sortBy=function(b){"ALL"===b?a.searchLetter=null:a.searchLetter=b,d()}}]).filter("highlight",["$sce",function(a){return function(b,c){var d=c.filterHighlight;if(b&&d){var e=d.split(" "),f=c.searchText?new RegExp(e.join("|"),"gi"):new RegExp("^"+e.join("|"),"gi");b=b.replace(f,function(a){return'<span class="highlighted">'+a+"</span>"})}return a.trustAsHtml(b)}}]).filter("byLastName",function(){return function(a,b){return _.filter(a,function(a){return new RegExp(b,"i").test(a.lastName.substring(0,1))})}}).filter("searchBox",function(){return function(a,b){if(b){b=b.toLowerCase();var c=b.split(" ");return _.filter(a,function(a){var b=a.firstName.toLowerCase(),d=a.lastName.toLowerCase(),e=[];return _.forEach(c,function(c){(_.includes(b,c)||_.includes(d,c)||_.includes(a.phone,c))&&e.push(!0)}),e.length===c.length})}return a}}),angular.module("customers",["customers.controllers","infinite-scroll"]).config(["$stateProvider",function(a){a.state("customers",{url:"/customers",templateUrl:"customers/partials/customersView.html",controller:"customersCtrl",data:{requireLogin:!0}})}]),angular.module("scheduling.controllers",[]).controller("schedulingCtrl",["$scope","$q","$timeout","coachSeekAPIService","$activityIndicator","sessionOrCourseModal","serviceDefaults","uiCalendarConfig",function(a,b,c,d,e,f,g,h){a.events=[],a.eventSources=[],a.currentRanges=[];var i,j,k;a.draggableOptions={helper:function(a){var b=$(this).data("service");return $('<span class="service-drag-helper '+b.presentation.colour+'">'+b.name+"<span/>")},cursorAt:{top:15,left:45}},a.toggleDrag=function(a){$(a.target).toggleClass("dragging")},a.uiConfig={calendar:{editable:!0,droppable:!0,allDaySlot:!1,slotEventOverlap:!1,firstDay:1,titleFormat:{month:"MMM YYYY",week:"MMM YYYY",day:"D MMM YYYY"},snapDuration:"00:15:00",defaultView:a.isBigScreen?"agendaWeek":"agendaDay",eventDurationEditable:!1,scrollTime:"06:00:00",header:{left:"",center:"prev title next",right:"month agendaWeek agendaDay today"},drop:function(a,b){o(a,$(this).data("service"))},events:function(b,c,e,f){var g={startDate:b.format("YYYY-MM-DD"),endDate:c.format("YYYY-MM-DD"),locationId:a.currentLocationId,coachId:a.currentCoachId,useNewSearch:!0,section:"Sessions"};D(),d.get(g).$promise.then(function(b){a.events=[],q(b.sessions),p(b.courses),f(a.events),a.$broadcast("fetchSuccesful")},a.handleErrors)["finally"](function(){E()})},eventRender:function(a,b,c){"month"!==c.type&&$("<div></div>",{"class":"fc-location",text:a.session.location.name}).appendTo(b.find(".fc-content"))},windowResize:function(a){m(a.name)},eventDrop:function(b,c,d){b.tempEventId?_.assign(a.currentEvent.session.timing,{startDate:b._start.format("YYYY-MM-DD"),startTime:b._start.format("HH:mm")}):b.course?(a.currentEvent=b,f(a).then(function(a){a===b.course.id?(D(),l(b.course,c,d,!0)):l(b.session,c,d,!1)},function(){d()})):l(b.session,c,d,!1)},eventClick:function(b,c,d){a.showModal||(a.currentTab="attendance"),(a.isBigScreen||"agendaDay"==d.type)&&(a.showModal=!0,k&&k.removeClass("current-event"),k=$(c.currentTarget),k.addClass("current-event")),a.currentEvent=b,j=angular.copy(b),b.course&&v()},viewRender:function(b){c(function(){var c=a.isBigScreen?$(".calendar-container").height()-10:$(window).height();h.calendars.sessionCalendar.fullCalendar("option","height",c),m(b)})},dayClick:function(b,c,d){a.isBigScreen||"month"!==d.type?Modernizr.touch&&o(b,angular.copy(g)):(h.calendars.sessionCalendar.fullCalendar("changeView","agendaDay"),h.calendars.sessionCalendar.fullCalendar("gotoDate",b))}}};var l=function(b,c,d,f){var g=B(b.timing);g.add(c),_.assign(b.timing,{startDate:g.format("YYYY-MM-DD"),startTime:g.format("HH:mm")}),e.startAnimating(),C(b).then(function(b){a.removeAlerts(),f&&h.calendars.sessionCalendar.fullCalendar("refetchEvents")},function(a){d(),n(a)})["finally"](function(){e.stopAnimating()})},m=function(b){var c=h.calendars.sessionCalendar;a.isBigScreen?c.find(".fc-agendaWeek-button").show():(c.find(".fc-agendaWeek-button").hide(),a.toggleOpen=!1,"agendaWeek"===b&&c.fullCalendar("changeView","agendaDay")),c.fullCalendar("option","height",$(".calendar-container").height()-10)},n=function(b){var c=b.data[0].data||b.data;c=c.substring(c.indexOf(":")+2,c.indexOf(";")),a.addAlert({type:"danger",message:"scheduling:clashing-error",clashingMessage:c})},o=function(b,c){a.currentTab="general",a.showModal=!0;var d=s(b,c),e=c.repetition.repeatFrequency;i=_.uniqueId("service_"),_.times(c.repetition.sessionCount,function(c){var f=r(moment(b).add(c,e),d);a.events.push(f),h.calendars.sessionCalendar.fullCalendar("renderEvent",f),0===c&&(a.currentEvent=f,a.currentEvent.course={pricing:f.session.pricing})})},p=function(a){_.forEach(a,function(a){q(a.sessions,a)})},q=function(b,c){_.forEach(b,function(b){var d=B(b.timing);a.events.push(r(d,b,c))})},r=function(a,b,c){var d=a.clone(),e=b.timing.duration;return e=30>e?30:e,{_id:i,tempEventId:i,title:b.service.name,start:moment(d),end:moment(d.add(e,"minutes")),
allDay:!1,className:b.presentation.colour,session:b,course:c}},s=function(b,c){return{service:c,location:{id:a.currentLocationId},coach:{id:a.currentCoachId},timing:{startDate:b.format("YYYY-MM-DD"),startTime:b.format("HH:mm"),duration:c.timing.duration},booking:{isOnlineBookable:c.booking?c.booking.isOnlineBookable:!0,studentCapacity:c.booking?c.booking.studentCapacity:1,bookings:[]},pricing:c.pricing,presentation:c.presentation,repetition:c.repetition}};a.filterSessions=function(){a.removeAlerts(),h.calendars.sessionCalendar.fullCalendar("refetchEvents")},a.minutesToStr=function(a){return Math.floor(a/60)+":"+a%60},a.getCurrentCoach=function(){return a.coachList?_.result(_.find(a.coachList,{id:a.currentCoachId}),"name"):void 0},a.cancelModalEdit=function(){j&&(_.assign(j.session.booking.bookings,a.currentEvent.session.booking.bookings),_.assign(a.currentEvent,j),h.calendars.sessionCalendar.fullCalendar("updateEvent",a.currentEvent)),y(!0)},a.saveModalEdit=function(){if(z(),a.currentSessionForm.$valid){var b=a.currentEvent.course;if(a.currentEvent.tempEventId&&b){var c=a.currentEvent.session;a.currentEvent.course.pricing&&a.currentEvent.course.pricing.coursePrice&&(c.pricing.coursePrice=a.currentEvent.course.pricing.coursePrice),u(c)}else b?f(a).then(function(c){u(c===b.id?t(b):a.currentEvent.session)}):u(a.currentEvent.session)}};var t=function(b){return _.assign(a.currentEvent.session,{id:b.id,repetition:b.repetition,timing:{duration:a.currentEvent.session.timing.duration,startDate:b.timing.startDate,startTime:a.currentEvent.session.timing.startTime},pricing:{sessionPrice:a.currentEvent.session.pricing.sessionPrice,coursePrice:b.pricing.coursePrice}})},u=function(b){D(),C(b).then(function(b){a.currentEvent.tempEventId?(A(),delete a.currentEvent.tempEventId,b.sessions?(a.currentEvent.session=b.sessions[0],a.currentEvent.course=b):a.currentEvent.session=b):y(),a.removeAlerts(),h.calendars.sessionCalendar.fullCalendar("refetchEvents")},x)};a.$on("fetchSuccesful",function(){a.currentEvent&&(a.currentEvent=_.find(a.events,function(b){return b.session.id===a.currentEvent.session.id}),a.currentEvent&&v())});var v=function(){a.currentCourseEvents=_.filter(a.events,function(b){return b.course&&b.course.id===a.currentEvent.course.id})};a.deleteSession=function(){a.currentEvent.course?f(a).then(w):w(a.currentEvent.session.id)};var w=function(b){D(),d["delete"]({section:"Sessions",id:b}).$promise.then(function(){a.addAlert({type:"success",message:b===a.currentEvent.session.parentId?"scheduling:delete-course-success":"scheduling:delete-session-success",name:a.currentEvent.session.service.name,startDate:a.currentEvent.start.format("MMMM Do YYYY, h:mm a")}),y(),h.calendars.sessionCalendar.fullCalendar("refetchEvents")},function(b){a.handleErrors(b),E()})},x=function(b){_.forEach(b.data,function(b){"clashing-session"===b.code?n(b):a.addAlert({type:"danger",message:b.message?b.message:b})}),E()},y=function(b){A(),a.$broadcast("closeTimePicker",b),a.currentSessionForm.$setUntouched(),a.currentSessionForm.$setPristine(),a.showModal=!1},z=function(){a.currentSessionForm.coaches.$setTouched(),a.currentSessionForm.locations.$setTouched(),a.currentSessionForm.sessionPrice.$setTouched(),a.currentSessionForm.coursePrice.$setTouched()},A=function(){i&&(h.calendars.sessionCalendar.fullCalendar("removeEvents",i),i=null)},B=function(a){return moment(a.startDate+" "+a.startTime,"YYYY-MM-DD HH:mm")},C=function(a){return d.save({section:"Sessions"},a).$promise},D=function(){a.calendarLoading||(a.calendarLoading=!0)},E=function(){a.calendarLoading=!1};a.$watch("currentEvent.session.repetition.sessionCount",function(b){a.currentEvent&&a.currentEvent.tempEventId&&2>b&&a.currentEvent.course.pricing&&a.currentEvent.course.pricing.coursePrice&&delete a.currentEvent.course.pricing.coursePrice}),D(),b.all({coaches:d.query({section:"Coaches"}).$promise,locations:d.query({section:"Locations"}).$promise,services:d.query({section:"Services"}).$promise}).then(function(b){a.coachList=b.coaches,a.locationList=b.locations,a.serviceList=b.services},function(b){a.handleErrors(b),E()})}]),angular.module("scheduling.directives",[]).directive("schedulingServicesList",function(){return{restrict:"E",replace:!1,templateUrl:"scheduling/partials/schedulingServicesList.html"}}).directive("modalSessionForm",["uiCalendarConfig",function(a){return{restrict:"E",replace:!1,templateUrl:"scheduling/partials/modalSessionForm.html",link:function(b){function c(a){return 0===a?!1:!a}b.changeServiceName=function(){var a=_.find(b.serviceList,{id:b.currentSessionForm.services.$viewValue});b.currentEvent.session.presentation.colour=a.presentation.colour,_.assign(b.currentEvent,{className:a.presentation.colour,title:a.name}),d()},b.changeLocationName=function(){var a=_.find(b.locationList,{id:b.currentSessionForm.locations.$viewValue});b.currentEvent.session.location=a,d()};var d=function(){b.currentEvent.tempEventId||a.calendars.sessionCalendar.fullCalendar("updateEvent",b.currentEvent)};b.requireSessionPrice=function(){return b.currentEvent&&b.currentEvent.course&&b.currentEvent.course.pricing?c(b.currentEvent.course.pricing.coursePrice):b.currentEvent&&1===b.currentEvent.session.repetition.sessionCount?!0:void 0},b.requireCoursePrice=function(){return b.currentEvent&&b.currentEvent.session.pricing?c(b.currentEvent.session.pricing.sessionPrice):void 0}}}}]).directive("startTimePicker",function(){return{scope:{startTime:"="},restrict:"E",templateUrl:"scheduling/partials/startTimePicker.html",link:function(a,b){a.editingTime=!1;var c,d=angular.element(b.find(".time-picker-container"));a.editTime=function(b){a.editingTime||(c=angular.copy(a.startTime),a.editingTime=!0)},a.$on("closeTimePicker",function(b,e){e&&c&&(a.startTime=c),a.editingTime=!1,d.one("$animate:after",function(){c=null})})}}}).directive("modalSessionAttendanceList",["coachSeekAPIService",function(a){return{restrict:"E",replace:!1,templateUrl:"scheduling/partials/modalSessionAttendanceList.html",link:function(b){b.showCustomers=!1,b.showCustomerList=function(){b.showCustomers=!0},b.hideCustomerList=function(){b.showCustomers=!1},b.blockAddBookings=function(){if(b.currentEvent){var a=b.currentEvent.session;return a.booking.studentCapacity-_.size(a.booking.bookings)<=0}},b.$watch("currentEvent",function(){b.showCustomers=!1}),a.query({section:"Customers"}).$promise.then(function(a){b.itemList=a},b.handleErrors)}}}]).directive("modalCustomerDetails",["coachSeekAPIService","$q",function(a,b){return{restrict:"E",replace:!1,templateUrl:"scheduling/partials/modalCustomerDetails.html",link:function(c){function d(a){_.each(c.currentCourseEvents,function(b){var c=_.find(b.session.booking.bookings,function(b){return b.parentId===a.id});c&&_.pull(b.session.booking.bookings,c)})}function e(b){var d=h(b);c.bookingLoading=!0,a.save({section:"Bookings"},d).$promise.then(function(a){_.assign(a.customer,{firstName:c.item.firstName,lastName:c.item.lastName}),a.course?(c.currentEvent.course.booking.bookings.push(a),f(a),c.isSessionStudent=!1,c.isCourseStudent=!0):(c.isSessionStudent=!0,c.isCourseStudent=!1,c.currentEvent.session.booking.bookings.push(a))},c.handleErrors)["finally"](function(){c.bookingLoading=!1})}function f(a){_.each(c.currentCourseEvents,function(b){var d=_.find(a.sessionBookings,function(a){return a.session.id===b.session.id});d&&(_.assign(d.customer,{firstName:c.item.firstName,lastName:c.item.lastName}),b.session.booking.bookings.push(d))})}function g(a){return _.filter(a,function(a){return a.customer.id===c.item.id})}function h(a){return{session:{id:a?c.currentEvent.course.id:c.currentEvent.session.id,name:c.currentEvent.session.service.name},customer:{id:c.item.id,firstName:c.item.firstName,lastName:c.item.lastName},paymentStatus:"awaiting-invoice",hasAttended:!1}}c.addStudent=function(f){if(c.isCourseStudent&&!f){var g=_.find(c.currentEvent.course.booking.bookings,function(a){return a.customer.id===c.item.id});c.bookingLoading=!0,a["delete"]({section:"Bookings",id:g.id}).$promise.then(function(){d(g),e(f)},c.handleErrors)}else if(c.currentEvent.course&&f){var h=[];_.each(c.currentCourseEvents,function(b){var d=_.find(b.session.booking.bookings,function(a){return a.customer.id===c.item.id});d&&h.push(a["delete"]({section:"Bookings",id:d.id}))}),c.bookingLoading=!0,b.all(h).then(function(){_.each(c.currentCourseEvents,function(a){var b=_.find(a.session.booking.bookings,function(a){return a.customer.id===c.item.id});b&&_.pull(a.session.booking.bookings,b),b=_.find(a.course.booking.bookings,function(a){return a.customer.id===c.item.id}),b&&_.pull(a.course.booking.bookings,b)}),e(f)},c.handleErrors)}else e(f)},c.$watch("currentEvent.session.booking.bookings",function(a){if(a){c.isSessionStudent=!1,c.isCourseStudent=!1;var b=g(a);_.size(b)&&b[0].parentId?c.isCourseStudent=!0:_.size(b)&&(c.isSessionStudent=!0)}},!0)}}}]).directive("customerBooking",["coachSeekAPIService","sessionOrCourseModal",function(a,b){return{restrict:"E",replace:!1,templateUrl:"scheduling/partials/customerBooking.html",link:function(c){function d(b,d){c.bookingLoading=!0,a["delete"]({section:"Bookings",id:b}).$promise.then(function(){_.pull(c.currentEvent.session.booking.bookings,c.booking),d&&e()},c.handleErrors)["finally"](function(){c.bookingLoading=!1})}function e(){_.each(c.currentCourseEvents,function(a){var b=_.find(a.session.booking.bookings,function(a){return a.customer.id===c.booking.customer.id});b&&_.pull(a.session.booking.bookings,b)})}function f(b){return c.bookingLoading=!0,a.save({section:"Bookings",id:c.booking.id},b).$promise}c.toggleAttendance=function(){f({commandName:"BookingSetAttendance",hasAttended:!c.booking.hasAttended}).then(function(){c.booking.hasAttended=!c.booking.hasAttended},c.handleErrors)["finally"](function(){c.bookingLoading=!1})},c.removeBooking=function(){c.currentEvent.course&&c.booking.parentId?b(c).then(function(a){a===c.currentEvent.course.id?d(c.booking.parentId,!0):d(c.booking.id)}):d(c.booking.id)};var g=["awaiting-invoice","awaiting-payment","paid","overdue"],h=_.indexOf(g,c.booking.paymentStatus);-1===h&&(h=0),c.paymentStatus=g[h],c.changePaymentStatus=function(){h++,h===_.size(g)&&(h=0),c.paymentStatus=g[h],i()};var i=_.debounce(function(){f({commandName:"BookingSetPaymentStatus",paymentStatus:c.paymentStatus}).then(function(){c.booking.paymentStatus=c.paymentStatus},c.handleErrors)["finally"](function(){c.bookingLoading=!1})},1e3)}}}]),angular.module("scheduling",["scheduling.controllers","scheduling.directives","scheduling.services","ngDragDrop","ui.calendar"]).config(["$stateProvider",function(a){a.state("scheduling",{url:"/scheduling",templateUrl:"scheduling/partials/schedulingView.html",controller:"schedulingCtrl",data:{requireLogin:!0}})}]),angular.module("scheduling.services",[]).service("sessionOrCourseModal",["$modal","$rootScope",function(a,b){return function(b){b.removeAlerts();var c=a.open({scope:b,templateUrl:"scheduling/partials/sessionOrCourseModal.html",backdropClass:"session-or-course-modal-backdrop",windowClass:"session-or-course-modal-window"});return c.result.then(function(a){return a})}}]);